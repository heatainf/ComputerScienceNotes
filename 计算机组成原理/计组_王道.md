





# 第三章、存储系统

## 3.1存储器概述

### 3.1.1 存储器的分类



![img](计组_王道.assets\1648525060402-26a65cfb-d9d5-48af-b6eb-0515ddf0223c.png)

在此图中，**越往上层速度越快，容量越小，价格越高**



- 由于CPU的数据处理速度非常快，而辅存的速度非常慢，若主存直接从辅存读取的话会导致CPU的速度下降。
- 例如，微信App的打开。计算机会从辅存中调取微信的数据到主存（也就是内存），然后CPU再对其进行处理。

**辅存中的数据要被调入主存中才能被CPU访问。**





**高速缓冲存储器Cache的作用：**

- 虽然主存的速度已经很快了，但是远远不及CPU运算的速度。因此为了缓解这种速度差距，通常计算机硬件会把有可能经常访问的数据或代码从主存复制一份到Cache中，然后CPU可以直接读取cache中的副本数据。
- 例如，微信在进行视频聊天的时候，处理视频聊天的相关代码有可能会被频繁访问。此时可以把这段相关的代码复制到cache中。由于cache是更靠近上层的存储层，cache的读写速度会比较快，CPU读取cache的速度就会比直接读取主存的速度快很多，这样就可以保证视频聊天时的流畅。

![img](计组_王道.assets\1648525362611-7f17ba1c-bd2b-4e48-9314-45d645f58cce.png)

#### 1）按存储介质分类

1. **半导体存储器**（主存、Cache） ：以半导体器件存储信息
2. **磁表面存储器**（磁盘、磁带）：以磁性材料存储信息
3. **光存储器**（光盘）：以光介质存储信息



#### 2）按存取方式分类

1. **随机存取存储器（Random Access Memory,RAM）**：例如内存条，读写任何一个存储单元所需时间都相同，与存储单元所在的物理位置无关
2. **顺序存取存储器（Sequential Access Memory，SAM）**：例如磁带，读写一个存储单元所需时间取决于存储单元所在的物理位置
3. **直接存取存储器（Direct Access Memory，DAM）**：例如机械硬盘，既有随机存取特性，也有顺序存取特性。先直接选取信息所在区域，然后按顺序方式存取。
4. **相联存储器(Associative Memory)** ：即**可以按内容访问的存储器( Content Addressed Memory，CAM)**可以按照内容检索到存储位置进行读写，“快表”就是一种相联存储器

顺序存取存储器和直接存取存储器又可归为**串行访问存储器**：读写某个存储单元所需时间与存储单元的物理位置有关



#### 3）按信息的可更改性分类

1. **读写存储器（Read/Write Memory)**――即可读、也可写(如：磁盘、内存、Cache)
2. **只读存储器（Read Only Memory)**——只能读，不能写（如：实体音乐专辑通常采用CD-ROM,实体电影采用蓝光光碟，BIO通常写在ROM中)。事实上很多ROM也可多次读写，只是比较麻烦



#### 4）按信息的可保存性分类

1. **易失性存储器（主存、Cache)** ——断电后，存储信息消失的存储器
2. **非易失性存储器磁盘、光盘)**——断电后，存储信息依然保持的存储器
3. **破坏性读出**——（如DRAM芯片，读出数据后要进行重写)信息读出后，原存储信息被破坏
4. **非破坏性读出**——（如SRAM芯片、磁盘、光盘)信息读出后，原存储信息不被破坏



### 3.1.2存储器的性能指标

1.**存储容量**：存储字数×字长（如1M×8位）。MDR位数反映存储字长

2.**单位成本**：每**位(bit)**价格=总成本/总容量。

3.**存储速度**：数据传输率=数据的宽度/存储周期。数据的宽度即存储字长



![img](计组_王道.assets\1648529560845-3d62d342-939f-4154-9b2b-1d49b90b691c.png)



①存取时间（Ta）：存取时间是指从启动一次存储器操作到完成该操作所经历的时间，分为读出时间和写入时间。

②存取周期（Tm）：存取周期又称为读写周期或访问周期。它是指存储器进行一次完整的读写操作所需的全部时间，即连续两次独立地访问存储器操作（读或写操作）之间所需的最小时间间隔。

主存带宽（Bm）：主存带宽又称**数据传输率**，表示每秒从主存进出信息的最大数量，单位为字/秒、字节/秒（B/s）或位/秒（b/s）。



### 3.1 小结

![img](计组_王道.assets\1648529825696-521a7ee8-64b8-4a33-81ff-2dd9c6860364.png)



主存储器的基本组成























# 第六章、总线

## 6.1.1 总线概述

### 1、总线的定义

- 总线是一组能为多个部件分时共享的**公共信息传送线路**。

![image-20220525154342130](计组_王道.assets\image-20220525154342130.png)

**为什么要用总线?**

早期计算机外部设备少时大多采用分散连接方式，不易实现随时增减外部设备。为了更好地解决l/O设备和主机之间连接的灵活性问题，计算机的结构从分散连接发展为总线连接。

**总线的特点**

- **共享**是指总线上可以挂接多个部件，各个部件之间互相交换的信息都可以通过这组线路分时共享。
- **分时**是指同一时刻只允许有一个部件向总线发送信息,如果系统中有多个部件，则它们只能分时地向总线发送信息。

### 2、总线的特性

1. 机械特性：尺寸、形状、管脚数、排列顺序
2. 电气特性：传输方向和有效的电平范围
3. 功能特性：每根传输线的功能（地址、数据、控制）
4. 时间特性：信号的时序关系

### 3、总线的分类

1. 按数据传输格式分：串行总线、并行总线

2. 按总线功能（连接的部件）分：片内总线、系统总线、通信总线

3. 按时序控制方式：分同步总线、异步总线

#### 1）按数据传输格式分

##### 串行总线

![image-20220525152813405](计组_王道.assets\image-20220525152813405.png)

- 优点：只需要一条传输线，成本低廉，广泛应用于长距离传输；应用于计算机内部时可以节省布线空间。
-  缺点：在数据发送和接收的时候要进行拆卸和装配，要考虑串行并行转换的问题

##### 并行总线

![image-20220525153556944](计组_王道.assets\image-20220525153556944.png)

- 优点：总线的逻辑时序比较简单，电路实现起来比较容易。

- 缺点：信号线数量多，占用更多 的布线空间；远距离传输成本高昂；由于工作频率较高时，并行的信号线之间会产生严重干扰， 对每条线等长的要求也越高，所以无法持续提升工作频率。

#### 2）按总线功能（连接的部件）分

##### 1. 片内总线

- 片内总线是芯片内部的总线。 

- 它是CPU芯片内部寄存器与寄存器之间、寄存器与ALU之间的公共连接线。

##### 2. 系统总线

- 系统总线是计算机系统内各功能部件（CPU、主存、I/O接口）之间相互连接的总线。 

- 按系统总线**传输信息内容**的不同，又可分为3类：数据总线、地址总线和控制总线。

	- **数据总线**：数据总线用来传输各功能部件之间的数据信息，它是双向传输总线，其位数与机器字长、存储字长有关。双向传输。

	- **地址总线**：地址总线用来指出数据总线上的源数据或目的数据所在的主存单元或I/O端口的地址，它是单向传输总线，地址总线的位数与主存地址空间的大小有关。单向传输。

	- **控制总线**：控制总线传输的是控制信息，包括CPU送出的控制命令和主存（或外设）返回CPU的反馈信号。双向传输。

##### 3. 通信总线

- 通信总线是用于计算机系统之间或计算机系统与其他系统（如远程通信设备、测试设备） 之间信息传送的总线，通信总线也称为外部总线。

#### 3）按时序控制方式分

同步总线

异步总线

### 4、系统总线的结构

#### 单总线结构 

<img src="计组_王道.assets\image-20220525154911347.png" alt="image-20220525154911347" style="zoom: 67%;" />

**注**：单总线并不是指只有一根信号线，系统总线按传送信息的不同可以细分为地址总线、数据总线和控制总线。

- **结构**：CPU、主存、I/O设备（通过I/O接口）都连接在一组总线上，允许I/O设备之间、 I/O设备和CPU之间或I/O设备与主存之间直接交换信息。 
- **优点**：结构简单，成本低，易于接入新的设备。 
- **缺点**：带宽低、负载重，多个部件只能争用唯一的总线，且不支持并发传送操作。

#### 双总线结构 

![image-20220525155219280](计组_王道.assets\image-20220525155219280.png)

**主存总线**：支持突发(猝发) 传送：送出一个地址，收到多个地址连续的数据。

**通道**：通道是具有特殊功能的处理器， 能对I/O设备进行统一管理。 通道程序放在主存中。

- **结构**：双总线结构有两条总线，一条是主存总线，用于CPU、主存和通道之间进行数据传送；另一条是I/O总线，用于多个外部设备与通道之间进行数据传送。 
- **优点**：将较低速的I/O设备从单总线上分离出来，实现存储器总线和I/O总线分离。
- **缺点**：需要增加通道等硬件设备。

#### 三总线结构

<img src="计组_王道.assets\image-20220525155527125.png" alt="image-20220525155527125" style="zoom:80%;" />

**DMA**：Direct Memory Access，直接内存访问。

- 结构：三总线结构是在计算机系统各部件之间采用3条各自独立的总线来构成信息通路， 这3条总线分别为主存总线、I/O总线和直接内存访问DMA总线。
- 优点：提高了I/O设备的性能，使其更快地响应命令，提高系统吞吐量。
- 缺点：系统工作效率较低。

#### 四总线结构

<img src="计组_王道.assets\image-20220525155724822.png" alt="image-20220525155724822" style="zoom: 67%;" />

1. **桥接器**：用于连接不同的总线，具有数据缓冲、转换和控制功能。 
2. 靠近CPU的总线速度较快。 
3. 每级总线的设计遵循总线标准(见本章第4节)。

拓展：搜索“北桥芯片、南桥芯片”

### 本节回顾

![image-20220525160032854](计组_王道.assets\image-20220525160032854.png)

## 6.1.2 总线的性能指标

1.总线的传输周期(总线周期) 
2.总线时钟周期 
3.总线的工作频率 
4.总线的时钟频率 
5.总线宽度 
6.总线带宽 
7.总线复用 
8.信号线数

### 1.总线的传输周期(总线周期) 

1. 总线的传输周期(总线周期)：一次总线操作所需的时间（包括申请阶段、 寻址阶段、传输阶段和结束阶段），通常由若干个总线时钟周期构成。

2. 总线时钟周期：即机器的时钟周期。计算机有一个统一的 时钟，以控制整个计算机的各个部件，总 线也要受此时钟的控制。

总线周期与总线时钟周期的关系比较魔幻， 大多数情况下，一个总线周期包含多个总线时钟周期 有的时候，一个总线周期就是一个总线时钟周期 有的时候，一个总线时钟周期可包含多个总线周期

3. 总线的工作频率：总线上各种操作的频率，为总线周期的倒数。 若总线周期=N个时钟周期，则总线的工作频率=时钟频率/N。 实际上指一秒内传送几次数据。

4. 总线的时钟频率：即机器的时钟频率，为时钟周期的倒数。 若时钟周期为T，则时钟频率为1/T。 实际上指一秒内有多少个时钟周期。

5. 总线宽度：又称为总线位宽，它是总线上同时能够传输的数据位数， 通常是指数据总线的根数，如32根称为32位（bit）总线。 

6. 总线带宽 可理解为总线的数据传输率，即单位时间内总线上可传输 数据的位数，通常用每秒钟传送信息的字节数来衡量，单 位可用字节/秒（B/s）表示。

![image-20220525175203092](计组_王道.assets\image-20220525175203092.png)

**注：总线带宽是指总线本身所能达到的最高传输速率。 在计算实际的有效数据传输率时，要用实际传输的数据量除以耗时。**



